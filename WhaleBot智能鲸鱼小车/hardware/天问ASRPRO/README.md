
# 🎙️ ASRPRO 2.0 + 天问 Block 开发指南

![Badge](https://img.shields.io/badge/Hardware-ASRPRO%202.0-blue) ![Badge](https://img.shields.io/badge/Software-Tianwen%20Block-green) ![Badge](https://img.shields.io/badge/Docs-v1.0-orange)

本文档旨在为开发者提供 ASRPRO 2.0 语音模块与天问 Block 开发平台的集成概览。重点阐述系统架构、核心运行逻辑以及外设通信的基础配置。

---

## 1. 平台概述 (Overview)

### 🧩 ASRPRO 2.0 硬件平台
ASRPRO 是一款高度集成的离线语音识别开发板，专为语音交互场景设计。其硬件架构具有以下特点：

*   **核心集成**：板载高性能语音处理模块，内置神经网络加速单元。
*   **声学前端**：集成高灵敏度麦克风接口与功率放大器（Power Amp），支持直接驱动扬声器。
*   **丰富外设**：
    *   **通信接口**：集成串口 (UART)、IIC 总线。
    *   **控制与采集**：提供 ADC（模数转换）、硬件定时器等资源。
*   **主要用途**：广泛应用于离线语音识别、简单的语音对话交互以及智能家居控制。

### 💻 天问 Block 软件平台
天问 Block (Tianwen Block) 是 ASRPRO 系列的官方开发环境，旨在通过图形化界面降低开发门槛。

*   **编程模式**：采用类 Sketch、Mixly 的积木式图形化编程界面。
*   **功能实现**：支持通过拖拽积木实现复杂的逻辑控制，底层自动编译为高效的执行代码。

---

## 2. 核心运行机制 (Core Mechanism)

理解 ASRPRO 的程序生命周期是开发的关键。在天问 Block 环境下，系统的执行逻辑遵循以下严格顺序：

> **初始化阶段**
> 系统上电后，首先执行**上电初始化**，紧接着执行**系统应用初始化**。

> **正常运行阶段**
> 完成初始化后，系统进入正常运行状态（主循环），处于持续监听模式。

> **事件触发机制**
> 当系统检测到**语音唤醒**或识别到预设的**命令词**时，会执行 `asrcore` 核心程序一次。所有的语音识别后处理逻辑（如回复语播放、信号输出）均应在此事件中实现。

---

## 3. 外设与通信配置 (Peripherals & Communication)

本项目主要利用 **串口 (UART)** 外设实现 ASRPRO 与外部设备（如串口屏、ESP32-S3 主控）的数据交互。

### 🔌 串口资源概览
ASRPRO 硬件上共包含 **3 个独立串口**，开发者需根据实际需求进行配置。

### ⚙️ 配置规范
在使用串口外设前，必须在初始化阶段完成以下参数定义：

1.  **初始化要求**：
    *   串口功能默认关闭，必须在程序启动时显式执行初始化模块。

2.  **波特率配置**：
    *   支持配置为固定的标准波特率档位1200，4800，9600，19200，38400，57600，115200，推荐配置为最高115200。
    *   *注意：通信双方的波特率必须保持严格一致。*

3.  **引脚定义**：
    *   串口的 TX/RX 引脚由硬件外设控制器直接决定。
    *   **不可修改性**：引脚映射是固定的，在使用时，需要注意和现有的引脚冲突情况。

---

## 4. 语音指令表 (Voice Command Table)

以下为本项目预设的语音识别指令集。指令分为**唤醒**、**安全控制**、**模式切换**及**运动控制**四大类。

| 语音指令 | 执行内容 (TTS/Action) | 指令摘要 |
| :--- | :--- | :--- |
| **天问五幺** | 🔊 播报：“我在” | **设备唤醒词**，用于激活语音交互状态。 |
| **紧急停止** | 🔇 无语音回复 | **最高优先级指令**，触发急停逻辑，中断当前所有动作。 |
| **取消紧急停止** | 🔇 无语音回复 | 解除急停锁定状态，恢复设备待机。 |
| **打开对话模式** | 🔇 无语音回复 | 切换系统至对话交互逻辑，准备接收聊天指令。 |
| **开始聊天** | 🔇 无语音回复 | 触发聊天功能模块。 |
| **打开运动模式** | 🔇 无语音回复 | 切换系统至运动控制逻辑，激活电机/底盘控制。 |
| **前进** | 🔇 无语音回复 | 控制设备向前移动。 |
| **后退** | 🔇 无语音回复 | 控制设备向后移动。 |
| **左平移** | 🔇 无语音回复 | 控制麦克纳姆轮/全向轮底盘向左平移。 |
| **右平移** | 🔇 无语音回复 | 控制麦克纳姆轮/全向轮底盘向右平移。 |
| **停止** | 🔇 无语音回复 | 结束当前移动指令，设备归零/刹车。 |
| **左转** | 🔇 无语音回复 | 控制设备原地向左旋转。 |
| **右转** | 🔇 无语音回复 | 控制设备原地向右旋转。 |
| **设置为持续运动状态** | 🔇 无语音回复 | 更改运动逻辑为“保持当前动作直到收到停止指令”。 |
| **退出持续运动状态** | 🔇 无语音回复 | 恢复默认运动逻辑（如点动模式或定时停止）。 |